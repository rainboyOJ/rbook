[[TOC]]

## 1 球不同,盒子不同,球与盒子一样多
 
有3个不同的球,编号为$1,2,3$,有$2$个不同盒子编号为$b_1,b_2,b_3$,现在把球放到盒子里,每个盒子恰好放一个球,有多少不同的放法?

$$
\begin{array}{c|c|c|c}
\text{盒子} & b_1 & b_2 & b_3 \\
\hline
\mathfrak{1} & 1&  2 & 3 \\
\mathfrak{2} & 1&  3 & 2 \\
\mathfrak{3} & 2&  1 & 3 \\
\mathfrak{4} & 2&  3 & 1 \\
\mathfrak{5} & 3&  1 & 2 \\
\mathfrak{6} & 3&  2 & 1 \\
\end{array}
$$


我们这样来思考这个题目,把$3$个球放在一起,找来$3$个小朋友,每个小朋友负责把球放到对应编号的盒子

小朋友法:

- 第$i$个小朋友,从剩余的球里取出一个编号最小的球,放到编号为$i$个的盒子里
- 剩下的球让后面的小朋友 取 
- 回溯到第$i$个小朋友的时候,++恢复现场++:把编号$i$盒子里的球的取回来后,再从剩余的球里取出一个编号比较上次取的球大的球,放到编号为$i$个的盒子里
  

<%- video("full_permutation.mp4")%>

学会了一个新的名词: 恢复现场


TODO: 重点讲解这个词语


```cpp
<%- include("./code/1.cpp")%>
```

这个代码的时间复杂度为$P(n,n)$


这种,记为把$n$个不同的数进行++全排列++,记为$P(n,n)$

$$
P(n,n) = \underbrace{n \times (n-1) \times \cdots \times 1}_{n} = n!
$$


## 2 球不同,盒子不同,盒子少于球

有3个不同的球,编号为$1,2,3$,有$2$个不同盒子编号为$b_1,b_2$,现在把球放到盒子里,每每个盒子恰好放一个球,有多少不同的放法?


$$
\begin{array}{c|c|c|c}
\text{盒子} & b_1 & b_2 \\
\hline
\mathfrak{1} & 1&  2 \\
\mathfrak{2} & 1&  3 \\
\mathfrak{3} & 2&  1 \\
\mathfrak{4} & 2&  3 \\
\mathfrak{5} & 3&  1 \\
\mathfrak{6} & 3&  2 \\
\end{array}
$$

与上一个题目不同,这里的盒子的数量是少于球的数量的,那我们只要减少小朋友的数量到盒子的数量不就可以了吗.


```cpp
<%- include("./code/2.cpp")%>
```

这种,记为从$n$个不同的数里选$m$个数进行排列,记为$P(n,m)$

$$
P(n,m) = \underbrace{n \times (n-1) \times \cdots \times (n-m+1)}_{m} = \frac{n!}{(n-m)!}
$$


## 3 组合1: 球不同,盒子相同

有$5$个不同的球,编号为$1,2,3,4,5$,有$3$个相同盒子,现在把球放到盒子里,每个盒子恰好放一个球,有多少不现的放法?

注意,因为两个盒子一样,所以

$$
\def\arraystretch{1.5}
\begin{array}{c}
\boxed 1  & \boxed 2 & \boxed 3 \\
\boxed 1  & \boxed 3 & \boxed 2 \\
\boxed 2  & \boxed 1 & \boxed 3 \\
\boxed 2  & \boxed 3 & \boxed 1 \\
\boxed 3  & \boxed 1 & \boxed 2 \\
\boxed 3  & \boxed 2 & \boxed 1 \\
\end{array} \tag a
$$

这些结果都是一样的.

经过在纸上计算,得出一共有$10$种可能性

$$
\def\arraystretch{1.5}
\begin{array}{ccc}
\mathfrak{1} &\boxed 1& \boxed 2 & \boxed 3 \\
\mathfrak{2} &\boxed 1& \boxed 2 & \boxed 4 \\
\mathfrak{3} &\boxed 1& \boxed 2 & \boxed 5 \\
\mathfrak{4} &\boxed 1& \boxed 3 & \boxed 4 \\
\mathfrak{5} &\boxed 1& \boxed 3 & \boxed 5 \\
\mathfrak{6} &\boxed 1& \boxed 4 & \boxed 5 \\
\mathfrak{7} &\boxed 2& \boxed 3 & \boxed 4 \\
\mathfrak{8} &\boxed 2& \boxed 3 & \boxed 5 \\
\mathfrak{9} &\boxed 2& \boxed 4 & \boxed 5 \\
\mathfrak{10} &\boxed 3& \boxed 4 & \boxed 5 \\
\end{array}
$$


有三个小朋友,每个小朋友拿一个盒子,开始拿球,已经拿了$1,2,3$后,如何避免拿$1,3,2$或$3,2,1$等重复的情况呢?

答案就是: 保证第$i$个小朋友拿的球的编号大于前面的第$i-1$个小朋友拿的球的编号.


数学原理: ++定序唯一性++,在$(a)$中这些重复的放法里,有序的只有一个.保证有序,可以避免重复.

注意:这里不需要标记球是否已经被拿了,因为选的球的编号一定比前面的大.所以也不需要恢复现场,也不需要放回球.

```cpp
<%- include("./code/3.cpp")%>
```

时间复杂度的计算:从$n$中选取$m$个数,有多秒种可能性,我们把这称为++组合++,记为$C(n,m)$,或$C_n^m$

$$
C(n,m) = \frac{ P(n,m)}{m!} = \frac{n!}{m! \cdot (n-m)!}
$$

- <%- pid_to_url('luogu','1157','组合的输出') %>

## 4 组合2: 全组合

有$5$个不同的球,编号$1,2,3,4,5$,有一个魔法盒子,它的数量可以变化,最多有$5$个,这个盒子可以放一个球,小朋友可以拿任意个盒子来放球,问有多少不现的放法? 并输出所有不现的放法.

容易,想到只要写一个`for`循环调用上面代码的`comb`函数就可以了

```
for(int i =1;i<=n;i++) 
{
    m = i; //修改盒子的数量
    comb(1,0);
}
```


小朋友法,相比上面

- 每个小朋友开始选球的时候,把前面的小朋友选的球输出


```cpp
<%- include("./code/4.cpp")%>
```

时间: $O(2^n)$

## 球相同,盒子不同,不允许为空

有$5$个相同的球,有$2$个不相同盒子,编号为$b_1,b_2$,现在把球放到盒子里,每个盒子可以放多少个球,但不能为空,有多少不现的放法?

本题目其实求的是$x+y = 5$有多少种正解数解

$$
\def\arraystretch{1.5}
\begin{array}{ccc}
& b_1 & b_2 \\
\hline
\mathfrak{1} &\boxed 1& \boxed 4  \\
\mathfrak{2} &\boxed 2& \boxed 3  \\
\mathfrak{3} &\boxed 3& \boxed 2  \\
\mathfrak{4} &\boxed 4& \boxed 1  \\
\end{array}
$$

因为只有两个盒子,可以直接写`for`循环来进行枚举

```cpp
for(int i =1 ;i<=5;i++)
{
    int j = 5 - i;
    if( j > 0) {
        cout << i << " " << j << endl; 
    }
}
```

但是如果盒子的数量不固定呢?那就不知道需要用几重`for`循环,所以这里使用递归,相当于动态的层数的`for`

这个题目本质上是求把$5$分成两份,不可以为$0$,有多少种分法. 也是排列组合的经典问题,隔板法.

```cpp
<%- include("./code/5.cpp")%>
```


## 球相同,盒子不同,允许为空

有$5$个相同的球,有$2$个不相同盒子,编号为$b_1,b_2$,现在把球放到盒子里,每个盒子可以放多个球,可以为空,有多少不现的放法?

与上面的解法一样,把代码里改成从$0$开始就可以了.这里也是隔板法.

- <%- pid_to_url('noiopenjudge', 'ch0202/666/','放苹果') %>


## 球相同,盒子相同,允许为空

有$5$个相同的球,有$2$个相同盒子,现在把球放到盒子里,每个盒子可以放多少个球,可以为空,有多少不现的放法?


$$
\def\arraystretch{1.5}
\begin{array}{ccc}
& b_1 & b_2 \\
\hline
\mathfrak{1} &\boxed 0& \boxed 5  \\
\mathfrak{2} &\boxed 1& \boxed 4  \\
\mathfrak{3} &\boxed 2& \boxed 3  \\
\end{array}
$$

本题目其实求的是$x+y = 5 \land x \leqslant y$有多少种正解数解


根据定序唯一性.只要保证当前的盒子的数量大于等于前面的盒子里的球的数量.




## 多种球,每种球有多个,不同的盒子

有$2$种相同的球,分别为$1,1,2$,有三个不同的盒子,编号为$b_1,b_2,b_3$,现在把球放到盒子里,每个盒子可以放一个球,有多少不同的放法?

$$
\def\arraystretch{1.5}
\begin{array}{ccc}
& b_1 & b_2 & b_3\\
\hline
\mathfrak{1} &\boxed 1& \boxed 1 & \boxed{2}  \\
\mathfrak{2} &\boxed 1& \boxed 2 & \boxed{1}  \\
\mathfrak{3} &\boxed 2& \boxed 1 & \boxed{1}  \\
\end{array}
$$

使用缩小放大法,先思考简单的问题

如果只有一个盒子,那方案数只能是$2$，因为只有两种球.

$$
\def\arraystretch{1.5}
\begin{array}{ccc}
& b_1 \\
\hline
\mathfrak{1} &\boxed 1 \\
\mathfrak{2} &\boxed 2 \\
\end{array}
$$

如果所有的球都一样,例如三个球都为:$\{1,1,1\}$,这个时候每个人都只能选$1$,只有一种可能性.

显然可得:对于任意人数且只有一种球的情况下,选球方案数为$1$

从集合的角度来看,设有重集:$A=\{1,1,2\}$,表示每一个小球,再设$3$个人在小球的集合$A$按要求选择后的形成的选法方案集合为$f(3,A)$

$$
f(3,A) = \{
 (1 , 1  , 2) ,
 (1 , 2  , 1 ),
 (2 , 1  , 1) \}
\tag{1}
$$

由$(1)$知:$|f(3,A)| = 3$.且由上知$|f(n,\{x| x_i = x_j\})| = 1$



利用**子问题分解**(集合分类)思想,显然第一个人在集合$A$上只有两种选球的方案:

1. 选$1$,剩余的小球集合为$B_1=\{1,2\}$,产生一个新问题,$f(2,B_1)$
2. 选$2$,剩余的小球集合为$B_2=\{1,1\}$,产生一个新问题,$f(2,B_2)$

那么$f(3,A) = f(2,B_1) \cup f(2,B_1)$,则$|f(3,A)| = |f(2,B_1)| + |f(2,B_1)|$,易知$|f(1,any)| = 1$

那么我们可以根据上面的公式,写一个递归算法来求答案

根据上面的代码,得知,把相同的球放到同一个箱子里,假如最后共有$m$个箱子,如果每个人每次从某个箱子里取一个球,不停的这样操作,最后可以得到所有的选球方案.

重要的思想是**分类**:相同的球算一类,对每个人来来说,**他选球的可能性就是球分类数$m$**


```cpp
<%- include("./code/6.cpp")%>
```

数学解:

有m组球,每组球有$a[i]$个,有n个箱子,问有多少个排列方式

本问题的本质,本题是数学上的**可重集合排列问题**

$$
\frac{n!}{\textstyle\prod_{i=1}^{m}a_i!}
$$




## 多种球,每种球有多个,相同的盒子

与上一题目类似,只不过把使用**定序唯一性**而已


## 球不同,盒子相同,可以多放,不可以为空

有$4$个不同的球,编号$1,2,3$,有$2$个相同的盒子,盒子可以放多个球,不可以为空,问有多少种放法.

**盒子不同**,也就是需要考虑顺序.

$$

\def\arraystretch{1.5}
\begin{array}{cc}
\boxed{1 \; 2 \; 3 } & \boxed{4} \\
\boxed{1 \; 2 \; 4 } & \boxed{3} \\
\boxed{1 \; 3 \; 4} & \boxed{2} \\
\boxed{2 \; 3 \; 4} & \boxed{1} \\
\boxed{1 \; 2} & \boxed{3 \; 4} \\
\boxed{1 \; 3} & \boxed{2 \; 4} \\
\boxed{2 \; 3} & \boxed{1 \; 4} \\
\end{array}
$$

暴力枚举法,考虑最后一个

数学解法,这个类型的题目 叫做第二类$Stirling$数

$$
S(n,r) = \left\{
\begin{array}{cc}
r\times S(n-1,r) + S(n-1,r-1) \\
0 & r = 0\\
1 & r = 1 \lor n = r
\end{array}
\right.
$$

## 球不同,盒子不同,可以多放,不可以为空


与上一个题目,不同就在于,**盒子不同**,也就是需要考虑顺序.

$$
G(n,r) = P(n,r) \times S(n,r)
$$

## 总结

## 练习题目

<%- include("./practice.md")%>

## 参考 

- [数论学习-组合数学再探](https://blog.csdn.net/qq_45933509/article/details/123012407)