## 球不同,盒子相同,可以多放,不可以为空

有$n$个不同的球,编号$1,2,3,\cdots,n$,有$m(\leqslant n)$个相同的盒子,盒子可以放多个球,不可以为空,问

1. 有多少种放法.
2. 列出所有的方案

**盒子相同**,也就是不需要考虑顺序.


首先了为理解题目,手动枚举(暴力)一下

$$
\def\arraystretch{1.5}
\begin{array}{cc}
\boxed{1 \; 2  } & \boxed{3} \\
\boxed{1 \; 3  } & \boxed{2} \\
\boxed{1} & \boxed{2 \; 3} \\
\end{array}
$$

有三种情况

当有$n=3,m=2$时,

当有$n=4,m=2$时,

$$
\def\arraystretch{1.5}
\begin{array}{cc}
\boxed{1 \; 2 \; 3 } & \boxed{4} \\
\boxed{1 \; 2 \; 4 } & \boxed{3} \\
\boxed{1 \; 3 \; 4} & \boxed{2} \\
\boxed{1  \; 4} & \boxed{2 \; 3} \\
\boxed{1 \; 2} & \boxed{3 \; 4} \\
\boxed{1 \; 3} & \boxed{2 \; 4} \\
\boxed{2 } & \boxed{2 \; 3 \; 4} \\
\end{array}
$$

设问题为$s(n,m)$,表示为有$n$个不同的球,$m$个相同的盒子时的放法数.

使用++缩小放大法++,先考虑最简单的情况,显然

- 当$n < m$时,不可能有方案,此为方案数为$0$
- 当$n = m$时,只有一种方案,此为方案数为$1$
- 当$m = 1$时,只有一种方案,此为方案数为$1$
  
当$n > m$时,考虑编号最大的那个球$n$,显然

- 要么编号为$n$的球单独放一个盒子,此时,取走$1$个盒子,问题变成$s(n-1,m-1)$
- 要么编号为$n$的球和其它球在一个盒子,可以这样认为,其它的球先放$m$个盒子里,因为球不同,这$m$个盒子里,每个盒子单独来看,里面的球即使数量一样,球也不样,**可以认为此时有$m$个不同的盒子**,那么编号为$n$的球可以任选一个盒子来放,有$m$种放法.共有方法数为$m \times s(n-1,m)$


综上所述

$$
s(n,m) = \left\{
\begin{array}{cl}
0 &  n < m \\
1 & n = m \\
1 & m =1 \\
s(n-1,m-1) + m\times s(n-1,m) &n > m
\end{array}
\right.
$$

数学解法,这个类型的题目 叫做第二类$Stirling$数

验证/演示:

```
s(4,2) ---- s(3,1) [1,2,3]
    |
    +------s(3,2) -----> s(2,1) [1 2]
             |
             +---------> s(2,2) [1] [2]
        [1 2] [3]
        [1 3] [2]
        [1] [2 3] ----+
                      |
s(4,2) =              |
[1 2 3] [4]           |
                      |
[1 2 4] [3] <---------+
[1 2] [3 4]
[1 3 4] [2]
[1 3] [2 4]
[1 4] [2 3]
[1] [2 3 4]
```

所以对于第一问: 得到如下的求方案数的代码


```cpp
int s[100][100];

int stirling(n,m) {
    if( n < m) return 0;
    if( n == m || m == 1) return 1;

    //记忆化
    if( !s[n][m]) return s[n][m];
    s[n][m] = stirling(n-1,m-1) + m*stirling(n-1,m);
    return s[n][m];
}
```


第二问: 根据上面的验证的过程,对于$n$号球,

- 它要么单独放一个盒子,这个盒子此时就是就后一个盒子
- 要么每个盒子都放一下
  
对于球i来说,记录他在哪个盒子里

```cpp
<%- include("./code/stirling2.cpp")%>
```


其它情况


1. 球不同,盒子不同,可以多放,不可以为空

与上一个题目,不同就在于,**盒子不同**,也就是需要考虑顺序.

$$
\begin{aligned}
G_1(n,r) &= P(m,m) \times S(n,m) \\
       &= m! \times S(n,m)
\end{aligned}
$$




1. 球不同,盒子相同,可以为空

$$
\begin{aligned}
G_2(n,r) &= S(n,1) + S(n,2) + \cdots +S(n,m) \\
       &= \sum_{i=1}^{m}S(n,i)
\end{aligned}
$$

